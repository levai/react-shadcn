# Git 提交规范

本文档定义了项目的 Git 提交消息格式规范，遵循 [Conventional Commits](https://www.conventionalcommits.org/) 标准。

## 📋 基本格式

```
<type>: <subject>
```

- **type**: 提交类型（必填，小写）
- **subject**: 提交描述（必填，不超过 50 字符，使用中文）

## 🏷️ 提交类型（Type）

### feat - 新功能

用于添加新功能或特性。

**示例：**
```
feat: 添加用户登录功能
feat: 实现侧边栏拖拽排序
feat: 新增主题切换功能
```

**使用场景：**
- 添加新的页面或组件
- 添加新的 API 接口
- 添加新的功能模块
- 添加新的配置选项

### fix - 修复 Bug

用于修复代码中的错误或问题。

**示例：**
```
fix: 修复侧边栏折叠后宽度异常
fix: 修复表单验证逻辑错误
fix: 修复路由跳转后状态丢失问题
```

**使用场景：**
- 修复功能缺陷
- 修复 UI 显示问题
- 修复性能问题
- 修复兼容性问题

### docs - 文档变更

用于更新文档、注释或 README。

**示例：**
```
docs: 更新开发规范文档
docs: 添加 API 使用示例
docs: 更新 README 安装说明
```

**使用场景：**
- 更新项目文档
- 更新代码注释
- 更新开发规范
- 更新 README

### style - 代码格式

用于代码格式调整，不影响代码功能（如空格、缩进、换行等）。

**示例：**
```
style: 调整代码缩进格式
style: 统一使用单引号
style: 移除多余的空行
```

**使用场景：**
- 代码格式化
- 调整缩进
- 统一代码风格
- 移除多余空白

### refactor - 重构

用于代码重构，既不修复 bug 也不添加新功能。

**示例：**
```
refactor: 重构侧边栏组件结构
refactor: 优化状态管理逻辑
refactor: 提取公共工具函数
```

**使用场景：**
- 代码结构优化
- 提取公共逻辑
- 优化代码组织
- 改进代码可读性

### perf - 性能优化

用于性能相关的改进。

**示例：**
```
perf: 优化列表渲染性能
perf: 减少不必要的重渲染
perf: 优化打包体积
```

**使用场景：**
- 优化渲染性能
- 减少资源加载
- 优化打包体积
- 优化算法效率

### test - 测试相关

用于添加或修改测试代码。

**示例：**
```
test: 添加登录功能单元测试
test: 更新组件测试用例
test: 修复测试用例错误
```

**使用场景：**
- 添加单元测试
- 添加集成测试
- 更新测试用例
- 修复测试问题

### build - 构建相关

用于构建系统或外部依赖的变更。

**示例：**
```
build: 更新 Vite 版本到 7.2.4
build: 配置生产环境构建优化
build: 添加新的构建脚本
```

**使用场景：**
- 更新构建工具版本
- 修改构建配置
- 添加构建脚本
- 优化构建流程

### ci - CI 配置

用于 CI/CD 配置文件的变更。

**示例：**
```
ci: 配置 GitHub Actions 工作流
ci: 更新 ESLint 检查规则
ci: 添加自动化测试流程
```

**使用场景：**
- 更新 CI 配置
- 添加自动化流程
- 更新检查规则
- 配置部署流程

### chore - 其他变更

用于其他不修改源代码或测试文件的变更。

**示例：**
```
chore: 更新依赖包版本
chore: 清理无用文件
chore: 更新 .gitignore
```

**使用场景：**
- 更新依赖包
- 清理无用文件
- 更新配置文件
- 其他维护性工作

### revert - 回滚

用于撤销之前的提交。

**示例：**
```
revert: 回滚 feat: 添加用户登录功能
revert: 回滚 fix: 修复侧边栏折叠问题
```

**使用场景：**
- 撤销错误的提交
- 回滚有问题的功能
- 恢复之前的版本

## ✍️ 提交描述（Subject）规范

### 基本要求

1. **使用中文**：所有提交描述使用中文
2. **简洁明了**：不超过 50 个字符
3. **使用祈使句**：描述"做了什么"而不是"做了什么修改"
4. **首字母小写**：不需要大写开头
5. **不加句号**：末尾不加标点符号

### ✅ 正确示例

```
feat: 添加用户登录功能
fix: 修复侧边栏折叠问题
docs: 更新开发规范文档
refactor: 优化状态管理逻辑
```

### ❌ 错误示例

```
feat: 添加用户登录功能。  // ❌ 末尾加了句号
feat: 添加了用户登录功能  // ❌ 使用了"了"字
feat: 添加用户登录功能，包括用户名和密码验证  // ❌ 超过 50 字符
feat: 添加用户登录功能（重要）  // ❌ 包含括号和额外信息
```

## 📝 完整示例

### 新功能

```
feat: 添加侧边栏拖拽排序功能
feat: 实现主题色切换功能
feat: 新增用户权限管理页面
```

### 修复 Bug

```
fix: 修复侧边栏折叠后宽度异常
fix: 修复表单提交后数据未清空问题
fix: 修复路由跳转后状态丢失
```

### 文档更新

```
docs: 更新 Git 提交规范文档
docs: 添加侧边栏开发规范说明
docs: 更新 API 接口文档
```

### 代码重构

```
refactor: 重构侧边栏组件结构
refactor: 提取公共工具函数到 shared 目录
refactor: 优化状态管理逻辑
```

### 性能优化

```
perf: 优化列表渲染性能
perf: 减少不必要的 API 请求
perf: 优化打包体积减少 30%
```

## 🤖 AI 生成 Commit Message 指南

当 AI 需要生成 commit message 时，请遵循以下步骤：

1. **分析变更内容**
   - 查看修改的文件
   - 理解代码变更的目的
   - 判断变更类型

2. **选择合适的类型**
   - 根据变更内容选择对应的 type
   - 如果不确定，优先选择 `feat`（新功能）或 `fix`（修复）

3. **编写简洁描述**
   - 用中文描述"做了什么"
   - 控制在 50 字符以内
   - 使用简洁的动词开头（添加、修复、更新、优化等）

4. **验证格式**
   - 确保格式为 `<type>: <subject>`
   - 确保 type 小写
   - 确保 subject 不超过 50 字符

### AI 生成示例

**场景 1：添加新功能**
```
变更：添加了用户登录页面和登录逻辑
生成：feat: 添加用户登录功能
```

**场景 2：修复 Bug**
```
变更：修复了侧边栏折叠后宽度显示异常的问题
生成：fix: 修复侧边栏折叠后宽度异常
```

**场景 3：更新文档**
```
变更：更新了 Git 提交规范文档，添加了 AI 生成指南
生成：docs: 更新 Git 提交规范文档
```

**场景 4：代码重构**
```
变更：重构了侧边栏组件，提取了公共逻辑
生成：refactor: 重构侧边栏组件结构
```

**场景 5：性能优化**
```
变更：优化了列表渲染，减少了不必要的重渲染
生成：perf: 优化列表渲染性能
```

## 🔍 常见问题

### Q: 如何判断是 feat 还是 fix？

**A:** 
- `feat`: 添加了新的功能或特性
- `fix`: 修复了已有的功能问题

**示例：**
- 添加登录功能 → `feat`
- 修复登录失败问题 → `fix`

### Q: 如何判断是 style 还是 refactor？

**A:**
- `style`: 只改变代码格式，不改变逻辑
- `refactor`: 改变代码结构或逻辑，但不改变功能

**示例：**
- 调整缩进和空格 → `style`
- 提取函数优化结构 → `refactor`

### Q: 多个变更如何提交？

**A:** 尽量拆分为多个提交，每个提交只做一件事。如果必须一起提交，选择最重要的变更类型。

**示例：**
```
变更：修复了 bug 并优化了性能
生成：fix: 修复问题并优化性能
```

### Q: 提交描述可以包含文件路径吗？

**A:** 不建议。提交描述应该描述"做了什么"，而不是"在哪里做的"。

**示例：**
- ❌ `fix: 修复 src/components/Sidebar.tsx 中的折叠问题`
- ✅ `fix: 修复侧边栏折叠问题`

## 📚 相关资源

- [Conventional Commits 规范](https://www.conventionalcommits.org/)
- [Commitlint 配置](./../../commitlint.config.cjs)
- [Husky Git Hooks](./../../.husky/README.md)

## ✅ 检查清单

提交前请确认：

- [ ] 提交类型（type）正确
- [ ] 提交描述（subject）使用中文
- [ ] 提交描述不超过 50 字符
- [ ] 提交描述简洁明了
- [ ] 格式为 `<type>: <subject>`
- [ ] 已通过 commitlint 检查
